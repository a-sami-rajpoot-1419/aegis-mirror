1. Core System Architecture
The system is a Sovereign Layer 1 built on the Cosmos SDK, utilizing CometBFT for consensus and Cosmos EVM (Ethermint) for execution.

The "Mirror" Principle (The Unified Account)
Requirement: Mathematical identity between 0x... (Ethereum) and mirror1... (Cosmos).

Implementation: The chain must use BIP-44 CoinType 60 (Ethereum's path) and EthSecp256k1 (Ethereumâ€™s curve) for all accounts.

Mechanism: When a user provides a private key, the chain derives a public key hash. This hash is then encoded twice: once as Hex (for EVM) and once as Bech32 (for Cosmos). They are the same account.

2. Technical Stack
Blockchain Framework: Cosmos SDK (v0.50+)

Consensus Engine: CometBFT (v0.38+)

EVM Library: cosmos/evm (The maintained successor to Ethermint)

Language: Go (Golang) 1.21+ for chain logic; Solidity 0.8.20+ for EVM logic.

UI/Frontend: Next.js (TypeScript), Tailwind CSS.

Libraries: ethers.js (EVM interaction), @cosmjs/stargate (Cosmos interaction).

DevOps: Docker, Docker-Compose, Ignite CLI.

3. Phase 1: Custom Chain Construction
Task 1.1: Project Scaffolding
Initialize a new chain with the correct address prefix:

Task 1.2: Account Configuration (The Identity Bridge)
You must override the default Cosmos account types.

Modify app/app.go: Configure the AccountKeeper and AuthKeeper to use ethermint.EthAccount.

Set BIP-44: In the chain configuration (config.yml), set the default coin type to 60.

Result: mirrorvaultd keys add will now generate addresses that start with mirror1 but share the same private key as a 0x address.

Task 1.3: Custom Business Logic Module (x/vault)
Create a Go module to store text data.

Store Type: map[string]string (Address -> Encrypted/Plain Text).

Message: MsgStoreSecret (Sender, Text).

Logic: A "Pre-Run" check that verifies if the user has an "Unlock Credit" (granted by the EVM side).

4. Phase 2: Inter-VM Business Logic
The "Mirror Vault" Workflow (Enhanced Dual-Wallet Design)

Solidity Contract (VaultGate.sol): 
- `payToUnlock()`: Grants storage credit (MetaMask only for v1)
- `storeMessage(string)`: Stores message via precompile (NEW - MetaMask path)
- `getMessageCount(address)`: View function to query credits
- `getLastMessage(address)`: View function to query last message
- Emits events with dual address formats (0x and mirror1)

Go Precompile (0x0101): Stateful precompile with 4 functions:
1. `unlock()`: Increments StorageCredit[caller] in x/vault
2. `storeMessage(string)`: Checks credit, stores message, decrements credit, updates global count/lastMessage
3. `getMessageCount(address)`: Query function (view/static call)
4. `getLastMessage(address)`: Query function (view/static call)

Key Design Principles:
- **Unified State**: Both wallets write to SAME on-chain x/vault state
- **Global Visibility**: messageCount and lastMessage are chain-wide (not per-user)
- **Dual Indexing**: All transactions emit both 0x and mirror1 addresses in events
- **User Choice**: Users pick which wallet to use based on fee comparison

5. Phase 3: Frontend & UI Specification
Layout Design
Theme: Dark Mode (Background: #0D1117, Primary: #58A6FF).

Top Bar:
- Left: Mirror Vault Logo
- Right: "Connect Wallets" button (MetaMask + Keplr)
- Connected Account Display: Shows BOTH 0x and mirror1 addresses

Main Dashboard (Unified View):
- **Account Section**: 
  - Displays both address formats (0x and mirror1) for connected account
  - Shows balance in both MVLT and wei formats
  - Balance is unified (same value in both wallets)

- **Global State Section** (visible to ALL users):
  - Total message count (chain-wide)
  - Last message preview (most recent from any user)
  - Same data regardless of which account is connected

- **Action Section** (Send Message):
  - Text input for message
  - **Fee Comparison**: Shows estimated gas for both paths:
    - MetaMask: VaultGate.storeMessage() via eth_estimateGas
    - Keplr: MsgStoreSecret via /cosmos/tx/v1beta1/simulate
  - User chooses which wallet to use
  - "Send via MetaMask" and "Send via Keplr" buttons

- **Center Conversion Tool**: 
  - Input any address (0x or mirror1)
  - Instantly shows both formats
  - Uses chain/utils/address.go conversion functions

Real-Time Logs (The Debug Bar)
Position: Bottom 20% of the screen.
Style: Terminal-like (Black background, green text).

Functionality:
- Stream events from chain (JSON-RPC and gRPC)
- **Dual Address Display**: Show both 0x and mirror1 in transaction events
- "Copy TX Hash" button next to every log
- Highlight errors in red
- Show which wallet was used (MetaMask/Keplr)

6. Phase 4: Testing & Documentation
Documentation Protocol
Swagger/OpenAPI: Auto-generated for the REST API (Port 1317).

Hardhat Docs: For the VaultGate.sol contract.

README.md: Detailed setup guide for docker-compose.

Test Matrix
